name: Atom Sayfa KaynaÄŸÄ±nÄ± Otomatik Al

# Ã‡alÄ±ÅŸma zamanlarÄ±
on:
  # Elle Ã§alÄ±ÅŸtÄ±rma butonu
  workflow_dispatch:
  
  # Otomatik zamanlama (her 6 saatte bir)
  schedule:
    - cron: '0 */6 * * *'  # Her 6 saatte bir
    
  # Push yapÄ±ldÄ±ÄŸÄ±nda
  push:
    branches: [ main, master ]
    
  # Pull request aÃ§Ä±ldÄ±ÄŸÄ±nda
  pull_request:
    branches: [ main, master ]

# Ä°zinler
permissions:
  contents: write
  pages: write
  id-token: write

# Ä°ÅŸ tanÄ±mÄ±
jobs:
  sayfa-kaydet:
    runs-on: ubuntu-latest
    
    steps:
    # 1. Repoyu klonla
    - name: ğŸ“¥ Repoyu Klonla
      uses: actions/checkout@v3
      with:
        fetch-depth: 0
    
    # 2. Python kur
    - name: ğŸ Python Kur
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
    
    # 3. Gerekli paketleri yÃ¼kle
    - name: ğŸ“¦ Paketleri YÃ¼kle
      run: |
        python -m pip install --upgrade pip
        pip install requests
    
    # 4. BetiÄŸi Ã§alÄ±ÅŸtÄ±r
    - name: ğŸš€ BetiÄŸi Ã‡alÄ±ÅŸtÄ±r
      run: |
        echo "ğŸ•’ Zaman: $(date)"
        python atom.py
      continue-on-error: true
    
    # 5. DosyalarÄ± kontrol et
    - name: ğŸ“‚ DosyalarÄ± Kontrol Et
      run: |
        echo "ğŸ“ Dizin iÃ§eriÄŸi:"
        ls -la
        echo ""
        if [ -f "atom.txt" ]; then
          echo "âœ… atom.txt bulundu"
          echo "ğŸ“Š Dosya boyutu: $(wc -l < atom.txt) satÄ±r"
          echo "ğŸ“Š Ä°lk 5 satÄ±r:"
          head -5 atom.txt
        else
          echo "âŒ atom.txt bulunamadÄ±!"
        fi
    
    # 6. DeÄŸiÅŸiklikleri commit et
    - name: ğŸ’¾ DeÄŸiÅŸiklikleri Kaydet
      run: |
        git config --global user.name "github-actions[bot]"
        git config --global user.email "github-actions[bot]@users.noreply.github.com"
        
        # atom.txt varsa ekle
        if [ -f "atom.txt" ]; then
          git add atom.txt
        fi
        
        # README varsa ekle
        if [ -f "README.md" ]; then
          git add README.md
        fi
        
        # Commit mesajÄ±
        git commit -m "ğŸ¤– Otomatik gÃ¼ncelleme: $(date '+%Y-%m-%d %H:%M:%S')" || echo "DeÄŸiÅŸiklik yok"
        
    # 7. GitHub'a gÃ¶nder
    - name: ğŸ“¤ GitHub'a GÃ¶nder
      uses: ad-m/github-push-action@v0.6.0
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        branch: ${{ github.ref }}
        force: true
    
    # 8. SonuÃ§larÄ± gÃ¶ster
    - name: âœ… SonuÃ§
      run: |
        echo "ğŸ‰ Ä°ÅŸlem tamamlandÄ±!"
        echo "ğŸ“Š Son durum:"
        echo "- Zaman: $(date)"
        echo "- Repo: ${{ github.repository }}"
        echo "- Branch: ${{ github.ref }}"
