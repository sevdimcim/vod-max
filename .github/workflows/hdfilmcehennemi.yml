name: HDFilmCehennemi Botu

on:
  workflow_dispatch:  # Manuel Ã§alÄ±ÅŸtÄ±rma iÃ§in
  schedule:
    - cron: '0 */6 * * *'  # Her 6 saatte bir Ã§alÄ±ÅŸsÄ±n (0, 6, 12, 18. saatler)
  push:
    paths:
      - 'hdfilmcehennemi.py'  # Bot dosyasÄ± deÄŸiÅŸirse Ã§alÄ±ÅŸsÄ±n

jobs:
  run-bot:
    runs-on: ubuntu-latest
    
    steps:
    # 1. Repoyu al
    - name: ğŸ“¥ Repoyu Ä°ndir
      uses: actions/checkout@v4
    
    # 2. Python kur
    - name: ğŸ Python 3.10 Kur
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
    
    # 3. Gerekli programlarÄ± kur
    - name: ğŸ“¦ KÃ¼tÃ¼phaneleri YÃ¼kle
      run: |
        python -m pip install --upgrade pip
        pip install requests beautifulsoup4 lxml
    
    # 4. Botu Ã§alÄ±ÅŸtÄ±r (15 sayfa, 0.03 saniye bekleme)
    - name: ğŸ¤– Film Botunu Ã‡alÄ±ÅŸtÄ±r
      run: |
        python hdfilmcehennemi.py 15 0.03
      env:
        PYTHONUNBUFFERED: "1"
    
    # 5. SonuÃ§larÄ± gÃ¶ster
    - name: ğŸ“Š Ä°ÅŸlem SonuÃ§larÄ±
      run: |
        echo "=== Ä°ÅLEM TAMAMLANDI ==="
        if [ -f "hdfilmcehennemi.json" ]; then
          echo "âœ… JSON dosyasÄ± oluÅŸturuldu"
          echo "Boyut: $(ls -lh hdfilmcehennemi.json | awk '{print $5}')"
        else
          echo "âŒ JSON dosyasÄ± oluÅŸturulamadÄ±"
        fi
        
        if [ -f "hdfilmcehennemi.html" ]; then
          echo "âœ… HTML dosyasÄ± oluÅŸturuldu"
          echo "Boyut: $(ls -lh hdfilmcehennemi.html | awk '{print $5}')"
        else
          echo "âŒ HTML dosyasÄ± oluÅŸturulamadÄ±"
        fi
    
    # 6. DeÄŸiÅŸiklikleri GitHub'a yÃ¼kle
    - name: ğŸ”„ GitHub'a GÃ¶nder
      run: |
        git config --local user.email "github-bot@example.com"
        git config --local user.name "GitHub Bot"
        
        # DeÄŸiÅŸiklik var mÄ± kontrol et
        git add hdfilmcehennemi.json hdfilmcehennemi.html || true
        
        if git diff --staged --quiet; then
          echo "ğŸŸ¢ Yeni film yok, gÃ¶nderilmeyecek"
        else
          git commit -m "ğŸ¤– Bot gÃ¼ncellemesi: $(date '+%d.%m.%Y %H:%M')"
          git push
          echo "âœ… Yeni filmler GitHub'a gÃ¶nderildi"
        fi
