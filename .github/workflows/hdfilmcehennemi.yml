name: Film Scraper

on:
  schedule:
    - cron: "0 */6 * * *"   # 6 saatte bir çalışır
  workflow_dispatch:        # Manuel çalıştırma butonu
  push:
    branches:
      - main

jobs:
  scrape:
    runs-on: ubuntu-latest

    steps:
    - name: Repo'yu klonla
      uses: actions/checkout@v3

    - name: Python kur
      uses: actions/setup-python@v4
      with:
        python-version: 3.10

    - name: Gerekli kütüphaneleri kur
      run: |
        pip install requests beautifulsoup4

    - name: Scraper çalıştır
      run: |
        echo ">>> Scraper çalışıyor..."
        python3 scraper.py

    - name: Değişiklik var mı kontrol et
      run: |
        if [ -z "$(git status --porcelain)" ]; then
          echo ">>> Değişiklik yok, commit yapılmayacak."
        else
          echo ">>> Değişiklik var, commit atılıyor..."
          git config --global user.email "github-actions@github.com"
          git config --global user.name "GitHub Actions"

          git add filmler.html
          git commit -m "Otomatik güncelleme - $(date '+%Y-%m-%d %H:%M:%S')"
          git push
        fi
